---
image: 77.png
title: "[è­¯æ–‡] Webpack 4: hash and contenthash and chunkhash, when to use which?"
category: tech
description: "someone have suggested a similar question to this one, but it only explains the differences between those hashes. BUT, I still can't figure out when should I choose [hash] instead of [contenthash]..."
tags: ['Webpack', 'frontend']
sourceimg1_n: Kama
sourceimg1_u: /
sourceimg2_n: Kama
sourceimg2_u: /
createdAtTime: '2023-07-13 14:22:17'
updatedAtTime: '2023-07-13 14:23:53'
slug: "77"
---

> In webpack 5, "hash" is deprecated and now you have the only option to use "contenthash"

**åœ¨ webpack 5 ä¸­ï¼Œâ€œhashâ€ å·²è¢«æ£„ç”¨ï¼Œç¾åœ¨å”¯ä¸€çš„é¸æ“‡æ˜¯ä½¿ç”¨ â€œcontenthashâ€**

**æœ¬ç¯‡å•é¡Œçš„ä¸»è¦è§£é‡‹ç‚º Webpack version 4.41.2 ç‚ºç‰ˆæœ¬**

ä½†è§£é‡‹çœŸçš„è »æ¸…æ¥šçš„ï¼Œå¯ä»¥å¹«åŠ©æˆ‘ç†è§£ï¼ˆï¼Ÿï¼‰æ‰€ä»¥åšå€‹ç­†è¨˜ã€‚

#### å•é¡Œ - Question
> someone have suggested a [similar question](https://stackoverflow.com/questions/35176489/what-is-the-purpose-of-webpack-hash-and-chunkhash) to this one, but it only explains the differences between those hashes.
> <br />
> **BUT, I still can't figure out when should I choose `[hash]` instead of `[contenthash]`? Can someone show me an example situation?**

æœ‰äººæå‡ºäº†ä¸€å€‹[é¡ä¼¼çš„å•é¡Œ](https://stackoverflow.com/questions/35176489/what-is-the-purpose-of-webpack-hash-and-chunkhash)ï¼Œä½†åªæ˜¯è§£é‡‹äº†é€™äº› Hash å€¼ä¹‹é–“çš„å·®ç•°ã€‚

ä½†æ˜¯ï¼Œæˆ‘ä»ç„¶ç„¡æ³•å¼„æ¸…æ¥šåœ¨ä»€éº¼æƒ…æ³ä¸‹æ‡‰è©²é¸æ“‡ `[hash]` è€Œä¸æ˜¯ `[contenthash]`ï¼Ÿæœ‰äººå¯ä»¥çµ¦æˆ‘å±•ç¤ºä¸€å€‹ä¾‹å­å—ï¼Ÿ

> === previous body ===
> <br/>
> The webpack docs explain different hashes type as following:
> <br/>
> <https://webpack.js.org/configuration/output/#outputfilename>
> <br/>
> **hash:** Unique hash generated for every build
> <br/>
> **contenthash:** Hashes generated for extracted content
> <br/>
> **chunkhash:** Hashes based on each chunks' content

=== åŸæ–‡ ===

Webpackæ–‡æª”å°ä¸åŒé¡å‹çš„å“ˆå¸Œé€²è¡Œäº†ä»¥ä¸‹è§£é‡‹ï¼š

https://webpack.js.org/configuration/output/#outputfilename

- **hashï¼š** æ¯æ¬¡æ§‹å»ºéƒ½ç”Ÿæˆå”¯ä¸€çš„ Hash å€¼ã€‚
- **contenthashï¼š** å°æå–çš„å…§å®¹ç”Ÿæˆ Hash å€¼ã€‚
- **chunkhashï¼š** åŸºæ–¼æ¯å€‹ chunk çš„å…§å®¹ç”Ÿæˆ Hash å€¼ã€‚

> I am still confused about when to use which type of the hashes.
> <br/>
> `[hash]` is generated for every build, but after running webpack build multiple times with following config, I didn't find my hash changed.

æˆ‘ä»ç„¶å°ä½•æ™‚ä½¿ç”¨å“ªç¨®é¡å‹çš„ Hash å€¼æ„Ÿåˆ°å›°æƒ‘ã€‚

`[hash]`æœƒç‚ºæ¯æ¬¡æ§‹å»ºç”Ÿæˆä¸€å€‹ Hash å€¼ï¼Œä½†æ˜¯åœ¨ä½¿ç”¨ä»¥ä¸‹é…ç½®å¤šæ¬¡é‹è¡Œ webpack æ§‹å»ºå¾Œï¼Œæˆ‘ç™¼ç¾æˆ‘çš„ Hash å€¼ä¸¦æ²’æœ‰æ”¹è®Šã€‚

```js
module.exports = {
  output: {
    filename: '[name].[hash].js'
  }
}
```
Webpack version 4.41.2

> I also find that the webpack config inside `react-scripts` is using contenthash for js and css file, but hash for assets files like images, this is also confusing, why are they doing it that way, is `[hash]` the better option for binary files?

æˆ‘é‚„ç™¼ç¾ï¼Œ`react-scripts` å…§éƒ¨çš„ webpack é…ç½®å°‡ contenthash ç”¨æ–¼ js å’Œ css æ–‡ä»¶ï¼Œä½†å°‡ hash ç”¨æ–¼åƒåœ–åƒé€™æ¨£çš„è³‡æºæ–‡ä»¶ï¼Œé€™ä¹Ÿä»¤äººå›°æƒ‘ï¼Œç‚ºä»€éº¼ä»–å€‘é€™æ¨£åšï¼Œ`[hash]` å°æ–¼äºŒé€²åˆ¶æ–‡ä»¶ä¾†èªªæ˜¯æ›´å¥½çš„é¸æ“‡å—ï¼Ÿ

#### å›ç­” - Answer
> Consider you have three generated bundles:

å‡è¨­ä½ æœ‰ä¸‰å€‹ç”Ÿæˆçš„ bundlesï¼š
```js
main.js
main.css
vendor.js
```

> `main.css` referred in `main.js` file.

`main.css` å¼•ç”¨æ–¼ `main.js` æª”æ¡ˆã€‚

###### Hash
> **Hash:** Hash number will be generated for each build. Generated Hash Number will be same for all the bundled files.

**Hashï¼ˆå“ˆå¸Œï¼‰ï¼š** æ¯æ¬¡æ§‹å»ºéƒ½æœƒç”Ÿæˆä¸€å€‹ Hash å€¼ã€‚æ‰€æœ‰æ‰“åŒ…çš„æ–‡ä»¶å°‡ä½¿ç”¨ç›¸åŒçš„ Hash å€¼ã€‚

For Example:

```js
Hash:

66e665r76798c278ytr6

# ç”Ÿæˆçš„æ–‡ä»¶
Generated Files:

main.66e665r76798c278ytr6.js
main.66e665r76798c278ytr6.css
vendor.66e665r76798c278ytr6.js
```

> All the three files will contain the same hash number. This hash will be same as long as you havent changed any content of the files. Even if you run many builds without changing any content, hash number will be same.

é€™ä¸‰å€‹æ–‡ä»¶å°‡åŒ…å«ç›¸åŒçš„ Hash å€¼ã€‚åªè¦ä½ æ²’æœ‰æ›´æ”¹æ–‡ä»¶çš„ä»»ä½•å…§å®¹ï¼Œé€™å€‹ Hash å€¼å°±æœƒç¶­æŒä¸è®Šã€‚å³ä½¿ä½ å¤šæ¬¡é€²è¡Œæ§‹å»ºè€Œæ²’æœ‰æ›´æ”¹ä»»ä½•å…§å®¹ï¼ŒHash å€¼ä¹Ÿå°‡ä¿æŒç›¸åŒã€‚

###### ChunkHash
> **ChunkHash:** In this case, Hash number will be generated based on the entrypoints and it will be different for all the files.

**ChunkHashï¼ˆç‰‡æ®µå“ˆå¸Œï¼‰ï¼š** åœ¨é€™ç¨®æƒ…æ³ä¸‹ï¼ŒHash å€¼æ˜¯æ ¹æ“šå…¥å£é»ç”Ÿæˆçš„ï¼Œä¸¦ä¸”å°æ–¼æ‰€æœ‰æ–‡ä»¶éƒ½æ˜¯ä¸åŒçš„ã€‚

For Example:

```js
Hash: 

66e665r76798c278ytr6

# ç”Ÿæˆçš„æ–‡ä»¶
Generated Files:

main.77e665r76798c278ytr6.js
main.78e665r76798c278ytr6.css
vendor.79e665r76798c278ytr6.js
```

> If you havent changed the vendor files, hash will be the same for the generated vendor file. But if you add any new vendor, hash number will be changed.
> <br/>
> If you made any changes in `main.js`, both `main.js` and `main.css` will be having new hash number since hash number is changed based on the entrypoint.

å¦‚æœä½ æ²’æœ‰æ›´æ”¹ä¾›æ‡‰å•†æ–‡ä»¶ï¼Œå‰‡ç”Ÿæˆçš„ä¾›æ‡‰å•†æ–‡ä»¶çš„ Hash å€¼å°‡ä¿æŒç›¸åŒã€‚ä½†å¦‚æœä½ æ·»åŠ äº†æ–°çš„ä¾›æ‡‰å•†ï¼ŒHash å€¼å°‡æœƒè®ŠåŒ–ã€‚

å¦‚æœä½ å° `main.js` é€²è¡Œäº†ä»»ä½•æ›´æ”¹ï¼Œ`main.js` å’Œ `main.css` éƒ½å°‡å…·æœ‰æ–°çš„ Hash å€¼ï¼Œå› ç‚º Hash å€¼æ˜¯æ ¹æ“šå…¥å£é»è€Œæ”¹è®Šçš„ã€‚

###### ContentHash
> **ContentHash:** Hash will be generated only if you made any changes in the particular file and each file will be having the unique has number.

**ContentHashï¼ˆå…§å®¹å“ˆå¸Œï¼‰ï¼š** åªæœ‰åœ¨ä½ å°ç‰¹å®šæ–‡ä»¶é€²è¡Œäº†æ›´æ”¹æ™‚ï¼Œæ‰æœƒç”Ÿæˆ Hash å€¼ï¼Œä¸¦ä¸”æ¯å€‹æ–‡ä»¶éƒ½å…·æœ‰å”¯ä¸€çš„ Hash å€¼ã€‚

> For Example, If you changed only `main.js` file, new hash will be generated only for the changed file, other two hash will be same as previous build
> <br/>
> Both Chunkhash and ContentHash generate hash number for each and every generated file. Only difference is ChunkHash generate hash based on the entrypoint.
> <br/>
> In most cases, you will be using ContentHash for production.
> <br/>
> With the help of contenthash, you can implement long term caching in the browsers. Browser will serve the cached file as long as the hash remains same.

ä¾‹å¦‚ï¼Œå¦‚æœä½ åªæ›´æ”¹äº† `main.js` æ–‡ä»¶ï¼Œå‰‡åªæœƒç‚ºæ›´æ”¹çš„æ–‡ä»¶ç”Ÿæˆæ–°çš„ Hash å€¼ï¼Œå…¶ä»–å…©å€‹æ–‡ä»¶çš„ Hash å€¼å°‡èˆ‡ä¹‹å‰çš„æ§‹å»ºç›¸åŒã€‚

ChunkHash å’Œ ContentHash éƒ½ç‚ºæ¯å€‹ç”Ÿæˆçš„æ–‡ä»¶ç”Ÿæˆ Hash å€¼ã€‚å”¯ä¸€çš„å€åˆ¥æ˜¯ ChunkHash æ ¹æ“šå…¥å£é»ç”Ÿæˆ Hash å€¼ã€‚

åœ¨å¤§å¤šæ•¸æƒ…æ³ä¸‹ï¼Œä½ å°‡åœ¨ç”Ÿç”¢ç’°å¢ƒä¸­ä½¿ç”¨ ContentHashã€‚

é€šé contenthash çš„å¹«åŠ©ï¼Œä½ å¯ä»¥åœ¨ç€è¦½å™¨ä¸­å¯¦ç¾é•·æœŸç·©å­˜ã€‚åªè¦ Hash å€¼ä¿æŒä¸è®Šï¼Œç€è¦½å™¨å°‡æä¾›ç·©å­˜çš„æ–‡ä»¶ã€‚

[Use `[contenthash]` over `[hash]` and `[chunkhash]` for better long term caching Â· Issue #2096 Â· webpack/webpack.js.org](https://github.com/webpack/webpack.js.org/issues/2096)

###### Long Term Caching
> **Long Term Caching:** To improve the app loading time, we often use caching. During initial load of the app, we can set the header for the assets as `Cache-Control: max-age=31536000`. After that, browser will cache the assets and subsequent requests will be served from the cache.

**Long Term Cachingï¼ˆé•·æœŸå¿«å–ï¼‰ï¼š** ç‚ºäº†æ”¹å–„æ‡‰ç”¨ç¨‹å¼çš„è¼‰å…¥æ™‚é–“ï¼Œæˆ‘å€‘é€šå¸¸ä½¿ç”¨å¿«å–ã€‚

åœ¨æ‡‰ç”¨ç¨‹å¼çš„åˆå§‹è¼‰å…¥æœŸé–“ï¼Œæˆ‘å€‘å¯ä»¥å°‡è³‡æºçš„æ¨™é ­è¨­å®šç‚º `Cache-Control: max-age=31536000`ã€‚

ä¹‹å¾Œç€è¦½å™¨å°‡å¿«å–é€™äº›è³‡æºï¼Œä¸¦å¾å¿«å–ä¸­æä¾›å¾ŒçºŒçš„è«‹æ±‚ã€‚

###### Without Hashing
> **Without Hashing:** Consider you have made changes in some assets(say `main.js`), since you have specified `max-age` as `31536000`, new changes will not get reflected, browser will continue to serve from cache.

**Without Hashingï¼ˆä¸ä½¿ç”¨å“ˆå¸Œï¼‰ï¼š** å‡è¨­ä½ å°æŸäº›è³‡æºé€²è¡Œäº†æ›´æ”¹ï¼ˆä¾‹å¦‚ `main.js`ï¼‰ï¼Œç”±æ–¼ä½ å°‡ `max-age` è¨­å®šç‚º `31536000`ï¼Œæ–°çš„æ›´æ”¹å°‡ä¸æœƒåæ˜ å‡ºä¾†ï¼Œç€è¦½å™¨å°‡ç¹¼çºŒå¾å¿«å–ä¸­æä¾›è©²è³‡æºã€‚

###### With Hashing
> **With Hashing:** To overrride this, we use hash across all the files. If you made any changes in the files, new hash will be generated and browser consider it as a new request.

**With Hashingï¼ˆä½¿ç”¨å“ˆå¸Œï¼‰ï¼š** ç‚ºäº†è¦†è“‹ï¼ˆä¸Šæ–¹ä¸ä½¿ç”¨ Hash å€¼çš„ï¼‰é€™ç¨®æƒ…æ³ï¼Œæˆ‘å€‘åœ¨æ‰€æœ‰æ–‡ä»¶ä¸­ä½¿ç”¨ Hash å€¼ã€‚å¦‚æœä½ å°æ–‡ä»¶é€²è¡Œäº†ä»»ä½•æ›´æ”¹ï¼Œå°‡ç”Ÿæˆæ–°çš„ Hash å€¼ï¼Œç€è¦½å™¨å°‡å°‡å…¶è¦–ç‚ºæ–°çš„è«‹æ±‚ã€‚

---

**Example:**

> You have made changes only in `main.js`. In case of `[hash]`, all the files will get the new hash number. browser will consider all the three as new and make three new requests to get the files
> <br/>
> This is not the case with `[contenthash]`. If you mentioned contenthash, then only `main.js` hash will be changed. Other two files will have the same hash number and will continue to serve from browser cache.
> <br/>
> This will improve your app loading time.

ä½ åªå° `main.js` é€²è¡Œäº†æ›´æ”¹ã€‚å¦‚æœä½¿ç”¨ `[hash]`ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½å°‡ç²å¾—æ–°çš„ Hash å€¼ã€‚ç€è¦½å™¨å°‡æŠŠæ‰€æœ‰é€™ä¸‰å€‹æ–‡ä»¶è¦–ç‚ºæ–°çš„è«‹æ±‚ï¼Œä¸¦ç™¼å‡ºä¸‰å€‹æ–°çš„è«‹æ±‚ä»¥ç²å–é€™äº›æ–‡ä»¶ã€‚

è€Œå¦‚æœä½¿ç”¨ `[contenthash]`ï¼Œå‰‡åªæœ‰ `main.js` çš„ Hash å€¼å°‡æ›´æ”¹ã€‚å…¶ä»–å…©å€‹æ–‡ä»¶å°‡å…·æœ‰ç›¸åŒçš„ Hash å€¼ï¼Œä¸¦å°‡ç¹¼çºŒå¾ç€è¦½å™¨å¿«å–ä¸­æä¾›ã€‚

é€™å°‡æ”¹å–„æ‡‰ç”¨ç¨‹å¼è¼‰å…¥æ™‚é–“ã€‚

---

> **If you need to implement long term caching, then it is advisable to use contenthash instead of normal hash.**
> <br/>
> **Generating hashes will increase the app compilation time. So you will be using contenthash/hash during production.**

**å¦‚æœä½ éœ€è¦å¯¦ç¾é•·æœŸå¿«å–ï¼Œå»ºè­°ä½¿ç”¨ contenthash è€Œä¸æ˜¯æ™®é€šçš„ hashã€‚**

**ç”Ÿæˆ Hash å€¼å°‡å¢åŠ æ‡‰ç”¨ç¨‹å¼çš„ç·¨è­¯æ™‚é–“ã€‚å› æ­¤ï¼Œåœ¨ç”Ÿç”¢ç’°å¢ƒä¸­ï¼Œä½ å°‡ä½¿ç”¨ contenthash / hashã€‚**

<br/>

For more info about long term caching:

[Make use of long-term caching](https://web.dev/use-long-term-caching/)

## ğŸ“š åŸæ–‡é€£çµ - Source Post Link

Webpack 4: hash and contenthash and chunkhash, when to use which? - Stack Overflow

<https://stackoverflow.com/questions/59194365/webpack-4-hash-and-contenthash-and-chunkhash-when-to-use-which>
